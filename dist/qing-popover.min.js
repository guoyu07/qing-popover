/* qing-popover v0.0.1 | (c) Mycolorway Design | MIT License */
!function(t,o){"object"==typeof module&&module.exports?module.exports=o(require("jquery"),require("qing-module")):t.QingPopover=o(t.jQuery,t.QingModule)}(this,function(t,o){var i=require=function t(o,i,e){function r(s,p){if(!i[s]){if(!o[s]){var h="function"==typeof require&&require;if(!p&&h)return h(s,!0);if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[s]={exports:{}};o[s][0].call(u.exports,function(t){var i=o[s][1][t];return r(i?i:t)},u,u.exports,t,o,i,e)}return i[s].exports}for(var n="function"==typeof require&&require,s=0;s<e.length;s++)r(e[s]);return r}({1:[function(i,e,r){var n,s=function(t,o){function i(){this.constructor=t}for(var e in o)p.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},p={}.hasOwnProperty,h=[].indexOf||function(t){for(var o=0,i=this.length;o<i;o++)if(o in this&&this[o]===t)return o;return-1};n=function(o){function i(o){i.__super__.constructor.apply(this,arguments),this.opts=t.extend({},i.opts,this.opts),this.pointTo=this.opts.pointTo,this.popover=this.opts.popover,this.boundary=this.pointTo.closest(this.opts.boundarySelector),this.boundary.length||(this.boundary=t(window))}return s(i,o),i.opts={pointTo:null,popover:null,direction:null,boundarySelector:null},i._directions=["direction-left-top","direction-left-middle","direction-left-bottom","direction-right-top","direction-right-bottom","direction-right-middle","direction-top-left","direction-top-right","direction-top-center","direction-bottom-left","direction-bottom-right","direction-bottom-center"],i.prototype._getSpaces=function(o){var i,e,r;return o[0]===window?{left:0,right:0,top:0,bottom:0}:(e=o.offset(),r=o.outerWidth(),i=o.outerHeight(),{left:e.left-t(window).scrollLeft(),right:t(window).scrollLeft()+t(window).width()-e.left-r,top:e.top-t(window).scrollTop(),bottom:t(window).scrollTop()+t(window).height()-e.top-i})},i.prototype.update=function(){var t,o,e,r,n,s;if(this.opts.direction?o=this.opts.direction.split("-"):(e=this._getSpaces(this.pointTo),t=this._getSpaces(this.boundary),s=["left","right","top","bottom"].reduce(function(o,i){return o[i]=e[i]-t[i],o},{}),n=[{direction:"right",beyond:Math.max(this.popover.outerWidth()-s.right,0)*this.popover.outerHeight()+Math.max(this.popover.outerHeight()-this.boundary.height(),0)*this.popover.outerWidth()},{direction:"left",beyond:Math.max(this.popover.outerWidth()-s.left,0)*this.popover.outerHeight()+Math.max(this.popover.outerHeight()-this.boundary.height(),0)*this.popover.outerWidth()},{direction:"bottom",beyond:Math.max(this.popover.outerHeight()-s.bottom,0)*this.popover.outerWidth()+Math.max(this.popover.outerWidth()-this.boundary.width(),0)*this.popover.outerHeight()},{direction:"top",beyond:Math.max(this.popover.outerHeight()-s.top,0)*this.popover.outerWidth()+Math.max(this.popover.outerWidth()-this.boundary.width(),0)*this.popover.outerHeight()}].sort(function(t,o){return t.beyond>o.beyond?1:-1}),o=[n[0].direction],/top|bottom/.test(o[0])?o[1]="center":/left|right/.test(o[0])&&(o[1]=s.top>s.bottom?"top":"bottom")),this.directions=o,r=this.toString(),h.call(i._directions,r)<0)throw new Error("[QingPopover] - direction is not valid")},i.prototype.toString=function(){return"direction-"+this.directions.join("-")},i}(o),e.exports=n},{}],2:[function(i,e,r){var n,s=function(t,o){function i(){this.constructor=t}for(var e in o)p.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},p={}.hasOwnProperty;n=function(o){function i(o){i.__super__.constructor.apply(this,arguments),this.opts=t.extend({},i.opts,this.opts),this.pointTo=this.opts.pointTo,this.popover=this.opts.popover,this.top=0,this.left=0}return s(i,o),i.opts={pointTo:null,popover:null,offset:0,align:{horizental:"center",vertical:"middle"}},i.prototype.update=function(t){return this.directions=t,this._position(),this._adjustAlign(),this._adjustOffset()},i.prototype._position=function(){var t,o,i,e,r;switch(o=this.pointTo.offset(),i=this.pointTo.outerWidth(),t=this.pointTo.outerHeight(),r=this.popover.outerWidth(),e=this.popover.outerHeight(),this.directions[0]){case"left":this.left=o.left-r;break;case"right":this.left=o.left+i;break;case"top":this.top=o.top-e;break;case"bottom":this.top=o.top+t}switch(this.directions[1]){case"top":return this.top=o.top-e+t/2;case"bottom":return this.top=o.top+t/2;case"left":return this.left=o.left-r+i/2;case"right":return this.left=o.left+i/2;case"center":return this.left=o.left+i/2-r/2;case"middle":return this.top=o.top+t/2-e/2}},i.prototype._adjustAlign=function(){if(/top|bottom/.test(this.directions[0]))switch(this.opts.align.horizental){case"left":this.left-=this.pointTo.width()/2;break;case"right":this.left+=this.pointTo.width()/2}if(/left|right/.test(this.directions[0]))switch(this.opts.align.vertical){case"top":return this.top-=this.pointTo.height()/2;case"bottom":return this.top+=this.pointTo.height()/2}},i.prototype._adjustOffset=function(){if(this.opts.offset)switch(this.directions[0]){case"top":return this.top-=this.opts.offset;case"bottom":return this.top+=this.opts.offset;case"left":return this.left-=this.opts.offset;case"right":return this.left+=this.opts.offset}},i}(o),e.exports=n},{}],"qing-popover":[function(i,e,r){var n,s,p,h=function(t,o){function i(){this.constructor=t}for(var e in o)c.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},c={}.hasOwnProperty;n=i("./direction.coffee"),s=i("./position.coffee"),p=function(o){function i(o){if(i.__super__.constructor.apply(this,arguments),this.opts=t.extend({},i.opts,this.opts),this.pointTo=t(this.opts.pointTo),!(this.pointTo.length>0))throw new Error("QingPopover: option el is required");i.destroyAll(),this._render(),this._bind(),this.refresh(),this.trigger("ready")}return h(i,o),i.opts={pointTo:null,cls:null,content:null,direction:null,offset:null,autohide:!0,align:{horizental:"center",vertical:"middle"}},i.ARROW_OFFSET=16,i._tpl='<div class="qing-popover">\n  <div class="qing-popover-content"></div>\n  <div class="qing-popover-arrow">\n    <i class="arrow arrow-shadow-0"></i>\n    <i class="arrow arrow-border"></i>\n    <i class="arrow arrow-basic"></i>\n  </div>\n</div>',i.prototype._render=function(){return this.popover=t(i._tpl).addClass(this.opts.cls),this.arrow=this.popover.find(".qing-popover-arrow"),this.content=this.popover.find(".qing-popover-content").append(this.opts.content),this.popover.data("qingPopover",this).appendTo("body"),this.pointTo.data("qingPopover",this),this.direction=new n({pointTo:this.pointTo,popover:this.popover,boundarySelector:this.opts.boundarySelector,direction:this.opts.direction}),this.position=new s({pointTo:this.pointTo,popover:this.popover,align:this.opts.align,offset:this.opts.offset})},i.prototype._bind=function(){if(t(window).on("resize.qing-popover",function(t){return function(){return t.refresh()}}(this)),this.opts.autohide)return t(document).on("mousedown.qing-popover",function(o){return function(i){var e;if(e=t(i.target),!(e.is(o.pointTo)||o.popover.has(e).length||e.is(o.popover)))return o.destroy()}}(this))},i.prototype.refresh=function(){return this.popover.removeClass(n._directions.join(" ")),this.arrow.css({top:"",bottom:"",left:"",right:""}),this.direction.update(),this.popover.addClass(this.direction.toString()).css(this._positionWithArrow())},i.prototype._positionWithArrow=function(){var t;switch(this.position.update(this.direction.directions),t={top:this.position.top,left:this.position.left},this.direction.directions[0]){case"top":t.top-=this.arrow.height();break;case"bottom":t.top+=this.arrow.height();break;case"left":t.left-=this.arrow.width();break;case"right":t.left+=this.arrow.width()}switch(this.direction.directions[1]){case"top":t.top+=this.arrow.height()/2+i.ARROW_OFFSET;break;case"bottom":t.top-=this.arrow.height()/2+i.ARROW_OFFSET;break;case"left":t.left+=this.arrow.width()/2+i.ARROW_OFFSET;break;case"right":t.left-=this.arrow.width()/2+i.ARROW_OFFSET}return t},i.prototype.destroy=function(){return t(window).off(".qing-popover"),t(document).off(".qing-popover"),this.pointTo.off(".qing-popover"),this.popover.remove(),this.pointTo.removeData("qingPopover")},i.destroyAll=function(){return t(".qing-popover").each(function(){var o,i;return o=t(this),i=o.data("qingPopover"),i.pointTo.index()===-1?o.remove():i.destroy()})},i}(o),e.exports=p},{"./direction.coffee":1,"./position.coffee":2}]},{},[]);return i("qing-popover")});