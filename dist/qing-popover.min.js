/* qing-popover v0.0.1 | (c) Mycolorway Design | MIT License */
!function(t,o){"object"==typeof module&&module.exports?module.exports=o(require("jquery"),require("qing-module")):t.QingPopover=o(t.jQuery,t.QingModule)}(this,function(t,o){var i=require=function t(o,i,e){function r(n,p){if(!i[n]){if(!o[n]){var h="function"==typeof require&&require;if(!p&&h)return h(n,!0);if(s)return s(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var a=i[n]={exports:{}};o[n][0].call(a.exports,function(t){var i=o[n][1][t];return r(i?i:t)},a,a.exports,t,o,i,e)}return i[n].exports}for(var s="function"==typeof require&&require,n=0;n<e.length;n++)r(e[n]);return r}({1:[function(i,e,r){var s,n=function(t,o){function i(){this.constructor=t}for(var e in o)p.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},p={}.hasOwnProperty;s=function(o){function i(o){i.__super__.constructor.apply(this,arguments),this.opts=t.extend({},i.opts,this.opts),this.qingPopover=this.opts.qingPopover,this._render()}return n(i,o),i.opts={qingPopover:null,cls:null,content:null},i._tpl='<div class="qing-popover">\n  <div class="qing-popover-content"></div>\n  <div class="qing-popover-arrow">\n    <i class="arrow arrow-shadow-0"></i>\n    <i class="arrow arrow-border"></i>\n    <i class="arrow arrow-basic"></i>\n  </div>\n</div>',i.prototype._render=function(){return this.el=t(i._tpl).addClass(this.opts.cls),this.arrow=this.el.find(".qing-popover-arrow"),this.content=this.el.find(".qing-popover-content").append(this.opts.content),this.el.data("qingPopover",this.qingPopover).appendTo("body")},i.prototype.destroy=function(){return this.el.remove()},i}(o),e.exports=s},{}],2:[function(i,e,r){var s,n=function(t,o){function i(){this.constructor=t}for(var e in o)p.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},p={}.hasOwnProperty,h=[].indexOf||function(t){for(var o=0,i=this.length;o<i;o++)if(o in this&&this[o]===t)return o;return-1};s=function(o){function i(o){i.__super__.constructor.apply(this,arguments),this.opts=t.extend({},i.opts,this.opts),this.pointTo=this.opts.pointTo,this.popover=this.opts.popover,this.arrow=this.opts.popover.find(".qing-popover-arrow"),this.doc=t(document),this.win=t(window)}return n(i,o),i.opts={pointTo:null,popover:null,direction:null,arrowOffset:16,offset:null,align:{horizental:"center",vertical:"middle"}},i._directions=["direction-left-top","direction-left-middle","direction-left-bottom","direction-right-top","direction-right-bottom","direction-right-middle","direction-top-left","direction-top-right","direction-top-center","direction-bottom-left","direction-bottom-right","direction-bottom-center"],i.prototype._getSpaces=function(){var t,o,i;return o=this.pointTo.offset(),i=this.pointTo.outerWidth(),t=this.pointTo.outerHeight(),{left:o.left-this.doc.scrollLeft(),right:this.doc.scrollLeft()+this.win.width()-o.left-i,top:o.top-this.doc.scrollTop(),bottom:this.doc.scrollTop()+this.win.height()-o.top-t}},i.prototype._getDirections=function(){var t,o,i;return this.opts.direction?this.opts.direction.split("-"):(i=this._getSpaces(),o=[{direction:"right",beyond:Math.max(this.popover.outerWidth()+this.arrow.outerWidth()-i.right,0)*this.popover.outerHeight()+Math.max(this.popover.outerHeight()-this.win.height(),0)*this.popover.outerWidth()},{direction:"left",beyond:Math.max(this.popover.outerWidth()+this.arrow.outerWidth()-i.left,0)*this.popover.outerHeight()+Math.max(this.popover.outerHeight()-this.win.height(),0)*this.popover.outerWidth()},{direction:"bottom",beyond:Math.max(this.popover.outerHeight()+this.arrow.outerHeight()-i.bottom,0)*this.popover.outerWidth()+Math.max(this.popover.outerWidth()-this.win.width(),0)*this.popover.outerHeight()},{direction:"top",beyond:Math.max(this.popover.outerHeight()+this.arrow.outerHeight()-i.top,0)*this.popover.outerWidth()+Math.max(this.popover.outerWidth()-this.win.width(),0)*this.popover.outerHeight()}].sort(function(t,o){return t.beyond>o.beyond?1:-1}),t=[o[0].direction],/top|bottom/.test(t[0])?t[1]="center":/left|right/.test(t[0])&&(t[1]=i.top>i.bottom?"top":"bottom"),t)},i.prototype.update=function(){var t,o,e,r,s,n,p,c,a,u,d;if(this.directions=this._getDirections(),this.direction="direction-"+this.directions.join("-"),u=this.direction,h.call(i._directions,u)<0)throw new Error("[QingPopover] - direction is not valid");switch(d=0,r=0,n=this.pointTo.offset(),p=this.pointTo.outerWidth(),s=this.pointTo.outerHeight(),a=this.popover.outerWidth(),c=this.popover.outerHeight(),e=this.arrow.width(),t=this.arrow.height(),o=this.opts.arrowOffset,this.directions[0]){case"left":r=n.left-e-a;break;case"right":r=n.left+p+e;break;case"top":d=n.top-t-c;break;case"bottom":d=n.top+s+t}switch(this.directions[1]){case"top":d=n.top+s/2+t/2+o-c;break;case"bottom":d=n.top+s/2-t/2-o;break;case"left":r=n.left+p/2+e/2+o-a;break;case"right":r=n.left+p/2-e/2-o;break;case"center":r=n.left+p/2-a/2;break;case"middle":d=n.top+s/2-c/2}if(/top|bottom/.test(this.directions[0]))switch(this.opts.align.horizental){case"left":r-=p/2;break;case"right":r+=p/2}if(/left|right/.test(this.directions[0]))switch(this.opts.align.vertical){case"top":d-=s/2;break;case"bottom":d+=s/2}return this.position=this._autoAdjustPosition(this._adjustOffset({top:d,left:r}))},i.prototype._autoAdjustPosition=function(t){var o,i,e,r,s,n;if(e=t.left,n=t.top,s=this.doc.scrollTop(),r=this.doc.scrollLeft(),o=this.opts.arrowOffset,/top|bottom/.test(this.directions[0])&&e<r)switch(i=r-e,e+=i,this.directions[1]){case"left":this.arrow.css("right",o+i);break;case"right":this.arrow.css("left",Math.max(o-i,o));break;default:this.arrow.css("marginLeft",-o/2-i)}if(/left|right/.test(this.directions[0])&&n<s)switch(i=s-n,n+=i,this.directions[1]){case"top":this.arrow.css("bottom",o+i);break;case"bottom":this.arrow.css("top",Math.max(o-i,o));break;default:this.arrow.css("marginTop",-o/2-i)}return{top:n,left:e}},i.prototype._adjustOffset=function(t){var o;return this.opts.offset?(o=this.opts.offset,/top|left/.test(this.directions[0])&&(o=-o),/top|bottom/.test(this.directions[0])&&(t.top+=o),/left|right/.test(this.directions[0])&&(t.left+=o),t):t},i}(o),e.exports=s},{}],"qing-popover":[function(i,e,r){var s,n,p,h=function(t,o){function i(){this.constructor=t}for(var e in o)c.call(o,e)&&(t[e]=o[e]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},c={}.hasOwnProperty;s=i("./popover.coffee"),n=i("./position.coffee"),p=function(o){function i(o){if(i.__super__.constructor.apply(this,arguments),this.pointTo=t(this.opts.pointTo),!(this.pointTo.length>0))throw new Error("QingPopover: option el is required");this.opts=t.extend({},i.opts,this.opts),i.destroyAll(),this._render(),this._bind(),this.refresh(),this.trigger("ready")}return h(i,o),i.opts={pointTo:null,cls:null,content:null,direction:null,arrowOffset:16,offset:null,autohide:!0,align:{horizental:"center",vertical:"middle"}},i.prototype._render=function(){return this.pointTo.addClass("qing-popover-point-to").data("qingPopover",this),this.popover=new s({qingPopover:this,cls:this.opts.cls,content:this.opts.content}),this.position=new n({pointTo:this.pointTo,popover:this.popover.el,direction:this.opts.direction,arrowOffset:this.opts.arrowOffset,offset:this.opts.offset,align:this.opts.align})},i.prototype._bind=function(){if(t(window).on("resize.qing-popover",function(t){return function(){return t.refresh()}}(this)),this.opts.autohide)return t(document).on("mousedown.qing-popover",function(o){return function(i){var e;if(e=t(i.target),!(e.is(o.pointTo)||o.popover.el.has(e).length||e.is(o.popover.el)))return o.destroy()}}(this))},i.prototype.refresh=function(){return this.popover.el.removeClass(n._directions.join(" ")),this.popover.arrow.css({top:"",bottom:"",left:"",right:""}),this.position.update(),this.popover.el.addClass(this.position.direction).css(this.position.position)},i.prototype.destroy=function(){return t(window).off(".qing-popover"),t(document).off(".qing-popover"),this.pointTo.off(".qing-popover"),this.popover.destroy(),this.pointTo.removeClass("qing-popover-point-to").removeData("qingPopover")},i.destroyAll=function(){return t(".qing-popover").each(function(){var o,i;return o=t(this),i=o.data("qingPopover"),i.pointTo.index()===-1?o.remove():i.destroy()})},i}(o),e.exports=p},{"./popover.coffee":1,"./position.coffee":2}]},{},[]);return i("qing-popover")});